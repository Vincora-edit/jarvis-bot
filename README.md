# –î–∂–∞—Ä–≤–∏—Å ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è Telegram

–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google Calendar, VPN-—Å–µ—Ä–≤–∏—Å–æ–º, —Å–∏—Å—Ç–µ–º–æ–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á –∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —Å–æ–±—ã—Ç–∏—è
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Calendar —á–µ—Ä–µ–∑ OAuth 2.0
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π: —Å–µ–≥–æ–¥–Ω—è, –∑–∞–≤—Ç—Ä–∞, –Ω–µ–¥–µ–ª—è, –º–µ—Å—è—Ü
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≥–æ–ª–æ—Å–æ–º –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–º
- –£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π ("–Ω–∞–π–¥–∏ –≤—Å—Ç—Ä–µ—á—É —Å –∫–æ–º–∞–Ω–¥–æ–π")
- –£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π –∫ —Å–æ–±—ã—Ç–∏—é

### AI-—Ñ—É–Ω–∫—Ü–∏–∏
- –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Whisper –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è)
- –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (GPT-4 Vision)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- –í–µ—á–µ—Ä–Ω—è—è —Ä–µ—Ñ–ª–µ–∫—Å–∏—è —Å AI

### –ü—Ä–∏–≤—ã—á–∫–∏ –∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è
- –¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫ —Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- –°–µ—Ä–∏–∏ (streaks) –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
- –£—Ä–æ–≤–Ω–∏ –∏ –±–µ–π–¥–∂–∏
- –£–º–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ —Å AI-–∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π

### –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–µ—Ç–æ–¥ 3+3: 3 –≥–ª–∞–≤–Ω—ã—Ö + 3 –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∏
- –£—Ç—Ä–µ–Ω–Ω–∏–π –ø–ª–∞–Ω –¥–Ω—è (8:00)
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ–±–∑–æ—Ä (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 21:00)
- –§–æ–∫—É—Å-—á–µ–∫–∏ –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞

### VPN-—Å–µ—Ä–≤–∏—Å (–¢—É–Ω–Ω–µ–ª—å)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Marzban
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- –¢–∞—Ä–∏—Ñ—ã –∏ –ª–∏–º–∏—Ç—ã —Ç—Ä–∞—Ñ–∏–∫–∞

### –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (Calendly-style)
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è –∑–∞–ø–∏—Å–∏
- –í—ã–±–æ—Ä —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –∏–∑ Google Calendar
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –æ –Ω–æ–≤—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö

### –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –±–æ–Ω—É—Å–∞–º–∏
- –ü—Ä–æ–º–æ–∫–æ–¥—ã —Å –≥–∏–±–∫–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
- –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã (FREE/PRO)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
jarvis-bot/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ create_bot.py           # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è aiogram –±–æ—Ç–∞
‚îú‚îÄ‚îÄ states.py               # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ oauth_server.py         # FastAPI —Å–µ—Ä–≤–µ—Ä –¥–ª—è Google OAuth
‚îÇ
‚îú‚îÄ‚îÄ handlers/               # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ Telegram
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ user.py            # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ tunnel.py          # –ö–æ–º–∞–Ω–¥—ã VPN-—Å–µ—Ä–≤–∏—Å–∞
‚îÇ
‚îú‚îÄ‚îÄ services/               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ ai_service.py      # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI GPT-4
‚îÇ   ‚îú‚îÄ‚îÄ calendar_service.py # Google Calendar API
‚îÇ   ‚îú‚îÄ‚îÄ google_oauth_service.py  # OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ habit_service.py   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ smart_habits_service.py  # –£–º–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ —Å AI
‚îÇ   ‚îú‚îÄ‚îÄ memory_service.py  # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ smart_reminder_service.py  # –£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ marzban_service.py # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Marzban VPN
‚îÇ   ‚îú‚îÄ‚îÄ promo_service.py   # –ü—Ä–æ–º–æ–∫–æ–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ referral_service.py # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ limits_service.py  # –õ–∏–º–∏—Ç—ã –∏ —Ç–∞—Ä–∏—Ñ—ã
‚îÇ   ‚îú‚îÄ‚îÄ plans.py           # –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ cleanup_service.py # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ encryption_service.py  # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ database/               # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ connection.py      # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
‚îÇ   ‚îî‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ keyboards/              # Telegram –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ actions.py         # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –∫–Ω–æ–ø–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ tunnel_kb.py       # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã VPN
‚îÇ
‚îú‚îÄ‚îÄ prompts/                # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ system_prompts.py  # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è GPT
‚îÇ
‚îú‚îÄ‚îÄ scheduler/              # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ jobs.py            # –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏ (APScheduler)
‚îÇ
‚îú‚îÄ‚îÄ booking/                # –ú–æ–¥—É–ª—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ api.py             # FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ service.py         # –õ–æ–≥–∏–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py         # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ templates/         # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ
‚îú‚îÄ‚îÄ admin-panel/            # –í–µ–±-–∞–¥–º–∏–Ω–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # FastAPI –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ
‚îú‚îÄ‚îÄ migrations/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ add_smart_habits_fields.py
‚îÇ
‚îú‚îÄ‚îÄ scripts/                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ broadcast_restart.py  # –†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
‚îÇ   ‚îî‚îÄ‚îÄ create_calendar.py    # –£—Ç–∏–ª–∏—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Google Calendar
‚îÇ
‚îú‚îÄ‚îÄ static/                 # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ css/
‚îÇ
‚îú‚îÄ‚îÄ utils/                  # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ
‚îú‚îÄ‚îÄ deploy.sh              # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ credentials.json       # Google API credentials
‚îú‚îÄ‚îÄ client_secret.json     # Google OAuth client secret
‚îú‚îÄ‚îÄ token.pickle           # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π OAuth —Ç–æ–∫–µ–Ω
‚îî‚îÄ‚îÄ bot_database.db        # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º |
| `/connect` | –ü–æ–¥–∫–ª—é—á–∏—Ç—å Google Calendar |
| `/today` | –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è |
| `/tomorrow` | –°–æ–±—ã—Ç–∏—è –Ω–∞ –∑–∞–≤—Ç—Ä–∞ |
| `/week` | –°–æ–±—ã—Ç–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é |

### –ü—Ä–∏–≤—ã—á–∫–∏
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/habits` | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å |
| `/habit_add` | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É |
| `/habit_done` | –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| `/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, XP, —É—Ä–æ–≤–µ–Ω—å |

### –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/plan33` | –ü–ª–∞–Ω –¥–Ω—è –ø–æ –º–µ—Ç–æ–¥—É 3+3 |
| `/focus` | –¢–µ–∫—É—â–∏–π —Ñ–æ–∫—É—Å |
| `/diary` | –õ–∏—á–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ |
| `/unload` | –†–∞–∑–≥—Ä—É–∑–∫–∞ –≥–æ–ª–æ–≤—ã |

### VPN –∏ –ø–æ–¥–ø–∏—Å–∫–∞
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/tunnel` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ VPN |
| `/ref` | –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ |
| `/promo` | –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥ |

### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/booking` | –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –∑–∞–ø–∏—Å–∏ |

---

## –ö–Ω–æ–ø–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é

- **üìã –ü–ª–∞–Ω** ‚Äî –ü–ª–∞–Ω –¥–Ω—è
- **‚úÖ –ü—Ä–∏–≤—ã—á–∫–∏** ‚Äî –¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫
- **üß† –†–∞–∑–≥—Ä—É–∑–∫–∞** ‚Äî –í—ã–≥—Ä—É–∑–∏—Ç—å –º—ã—Å–ª–∏
- **‚öôÔ∏è –†–µ–∂–∏–º** ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∂–∏–º–∞
- **üìÖ –ë—É–∫–∏–Ω–≥** ‚Äî –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–µ—á
- **üîí –¢—É–Ω–Ω–µ–ª—å** ‚Äî VPN-—Å–µ—Ä–≤–∏—Å
- **üë• –†–µ—Ñ–µ—Ä–∞–ª—ã** ‚Äî –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone <repo-url>
cd jarvis-bot
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```env
# Telegram
BOT_TOKEN=your_telegram_bot_token

# OpenAI
OPENAI_API_KEY=your_openai_api_key

# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=https://your-domain.com/callback

# Marzban VPN
MARZBAN_URL=https://your-marzban-server:8000
MARZBAN_USERNAME=admin
MARZBAN_PASSWORD=password

# Encryption
ENCRYPTION_KEY=your_fernet_key

# Timezone
TIMEZONE=Europe/Moscow
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Calendar API

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –í–∫–ª—é—á–∏—Ç–µ Google Calendar API
4. –°–æ–∑–¥–∞–π—Ç–µ OAuth 2.0 credentials
5. –°–∫–∞—á–∞–π—Ç–µ `credentials.json` –∏ `client_secret.json`
6. –î–æ–±–∞–≤—å—Ç–µ redirect URI: `https://your-domain.com/callback`

### 6. –ó–∞–ø—É—Å–∫

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
python main.py

# OAuth —Å–µ—Ä–≤–µ—Ä (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª)
python oauth_server.py

# –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª)
python admin-panel/main.py
```

---

## –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
```bash
./deploy.sh
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/jarvis-bot
git pull  # –∏–ª–∏ scp —Ñ–∞–π–ª–æ–≤
source venv/bin/activate
pip install -r requirements.txt
systemctl restart jarvis-bot
```

### Systemd —Å–µ—Ä–≤–∏—Å—ã

**–ë–æ—Ç** (`/etc/systemd/system/jarvis-bot.service`):
```ini
[Unit]
Description=Jarvis Telegram Bot
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/jarvis-bot
ExecStart=/root/jarvis-bot/venv/bin/python main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

**OAuth —Å–µ—Ä–≤–µ—Ä** (`/etc/systemd/system/jarvis-oauth.service`):
```ini
[Unit]
Description=Jarvis OAuth Server
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/jarvis-bot
ExecStart=/root/jarvis-bot/venv/bin/python oauth_server.py
Restart=always

[Install]
WantedBy=multi-user.target
```

---

## Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```nginx
# OAuth —Å–µ—Ä–≤–µ—Ä
server {
    listen 443 ssl;
    server_name djarvis.vincora.ru;

    ssl_certificate /etc/letsencrypt/live/djarvis.vincora.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/djarvis.vincora.ru/privkey.pem;

    # OAuth endpoints
    location /connect {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /callback {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
    }

    # Admin panel
    location /admin {
        proxy_pass http://127.0.0.1:8888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Booking
    location /book {
        proxy_pass http://127.0.0.1:8081;
        proxy_set_header Host $host;
    }
}
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

SQLite –±–∞–∑–∞ `bot_database.db` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–±–ª–∏—Ü—ã:

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞ |
| `habits` | –ü—Ä–∏–≤—ã—á–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `habit_logs` | –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫ |
| `user_tokens` | –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ OAuth —Ç–æ–∫–µ–Ω—ã |
| `vpn_users` | VPN –ø–æ–¥–ø–∏—Å–∫–∏ |
| `promo_codes` | –ü—Ä–æ–º–æ–∫–æ–¥—ã |
| `promo_code_usages` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ |
| `referrals` | –†–µ—Ñ–µ—Ä–∞–ª—ã |
| `booking_links` | –°—Å—ã–ª–∫–∏ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| `bookings` | –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏ |
| `user_schedule_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è |

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.11+**
- **aiogram 3.x** ‚Äî Telegram Bot API
- **FastAPI** ‚Äî OAuth —Å–µ—Ä–≤–µ—Ä, –∞–¥–º–∏–Ω–∫–∞, API –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **SQLAlchemy** ‚Äî ORM
- **APScheduler** ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- **OpenAI GPT-4** ‚Äî AI-–æ—Ç–≤–µ—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑
- **Whisper** ‚Äî –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏
- **Google Calendar API** ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º
- **Marzban** ‚Äî VPN –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **Jinja2 + HTMX** ‚Äî –®–∞–±–ª–æ–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- **Fernet** ‚Äî –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

---

## –ü–æ—Ä—Ç—ã

| –ü–æ—Ä—Ç | –°–µ—Ä–≤–∏—Å |
|------|--------|
| 8080 | OAuth —Å–µ—Ä–≤–µ—Ä |
| 8081 | Booking API |
| 8888 | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å |

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
